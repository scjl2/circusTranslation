%%%%%%%%%%%%%%%%%%%%%%
% Names and Acronyms %
%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\CDx}{\textsf{CD}$_{x}$}

\newcommand{\lname}[1]{\name{#1}}

\newcommand{\dd}{\hspace{-\zedindent}}

%%%%%%%%%%%%%%%
% Mathematics %
%%%%%%%%%%%%%%%

\newcommand{\deq}{\mathrel{{=}_{\mathrm{df}}}}
\newcommand{\defs}{\circdef}

\newcommand{\setdiff}{\mathbin{\backslash}}

\newcommand{\refby}{\mathbin{\sqsubseteq}}

%%%%%%%%%%%%
% Theorems %
%%%%%%%%%%%%

\newcommand{\provided}{\mathrel{\mathbf{provided}}}
\newcommand{\provwhere}{\mathrel{\mathbf{where}}}
\newcommand{\provand}{\mathrel{\mathbf{and}}}
\newcommand{\provor}{\mathrel{\mathbf{or}}}

% Legacy to parse stuff in the work directory.

\newcommand{\law}[1]{
  \vspace{0.7em}
  \nid \textbf{Law} (\name{#1})
  \vspace{-0.5em}
}

%%%%%%%%%%%%%%
% Z Language %
%%%%%%%%%%%%%%

%\newcommand{\pre}{\zpreop{pre}}

\newcommand{\real}{\mathbb{R}}

%%%%%%%%%%%
% Vectors %
%%%%%%%%%%%

\newcommand{\vplus}{\mathbin{+_{V}}}
\newcommand{\vminus}{\mathbin{-_{V}}}
\newcommand{\vtimes}{\mathbin{*_{V}}}
\newcommand{\vdot}{\mathbin{\cdot_{V}}}
\newcommand{\vsquare}{^{2}}
\newcommand{\lvlen}{{|}\hspace{1pt}}
\newcommand{\rvlen}{\hspace{1pt}{|}}

%%%%%%%%%%
% Circus %
%%%%%%%%%%

\newcommand{\emptytuple}{\!()}

\newcommand{\anyvar}{y}

\newcommand{\lcircassert}{\{}
\newcommand{\rcircassert}{\}}
\newcommand{\lcircassume}{[}
\newcommand{\rcircassume}{]}

\newcommand{\biglcircassume}{\left[\!\!\begin{array}{l}}
\newcommand{\bigrcircassume}{\end{array}\!\!\right]}

\newcommand{\FV}{\mathop{FV}}
\newcommand{\used}{\mathop{usedV}}
\newcommand{\wrt}{\mathop{wrtV}}
\newcommand{\usedC}{\mathop{usedC}}

\renewcommand{\Skip}{\circuskeyword{skip}}

%%%%%%%%%%%%%%
% SCJ Circus %
%%%%%%%%%%%%%%

% SCJ Paragraphs

\newcommand{\circsystem}{\zpreop{\circuskeyword{system}}}
\newcommand{\circsafelet}{\zpreop{\circuskeyword{safelet}}}
\newcommand{\circmsequencer}{\zpreop{\circuskeyword{sequencer}}}
\newcommand{\circmission}{\zpreop{\circuskeyword{mission}}}
\newcommand{\circhandler}{\zpreop{\circuskeyword{handler}}}
\newcommand{\circperiodic}{\zpreop{\circuskeyword{periodic}}}
\newcommand{\circaperiodic}{\zpreop{\circuskeyword{aperiodic}}}
\newcommand{\circactive}{\zpreop{\circuskeyword{active}}}

\newcommand{\circstatics}{\zpreop{\circuskeyword{statics}}}
\newcommand{\circsinit}{\zpreop{\circuskeyword{sinit}}}

% SCJ Methods

\newcommand{\circsetup}{\zpreop{\circuskeyword{setUp}}}
\newcommand{\circteardown}{\zpreop{\circuskeyword{tearDown}}}
\newcommand{\circgetnextmission}{\zpreop{\circuskeyword{getNextMission}}}
\newcommand{\circinitialize}{\zpreop{\circuskeyword{initialize}}}
\newcommand{\circcleanup}{\zpreop{\circuskeyword{cleanup}}}
\newcommand{\circmissionmemorysize}{\zpreop{\circuskeyword{missionMemorySize}}}

\newcommand{\circhandleasyncevent}{\zpreop{\circuskeyword{handleAsyncEvent}}}
\newcommand{\circdispatch}{\zpreop{\circuskeyword{dispatch}}}

% SCJ Language

\newcommand{\circfor}{\zpreop{\circuskeyword{for}}}
\newcommand{\circto}{\zbinop{\circuskeyword{to}}}
\newcommand{\circret}{\circuskeyword{ret}}
\newcommand{\circreturn}{\zpreop{\red{\circuskeyword{return}}}}

% Miscellaneous

\newcommand{\circself}{\circuskeyword{self}}
\newcommand{\circinitialscj}{\circinitial}
\newcommand{\circnewH}{\zpreop{\circuskeyword{newHandler}}}
\newcommand{\circnewE}{\zpreop{\circuskeyword{newEvent}}}
\newcommand{\circregister}{\zpreop{\circuskeyword{register}}}
\newcommand{\circfire}{\zpreop{\circuskeyword{fire}}}

%%%%%%%%%%%%%%%
% HiJaC Style %
%%%%%%%%%%%%%%%

\setlength{\zedindent}{\parindent}
\setlength{\zedtab}{\parindent}
\setlength{\zedskip}{0.4em}

%%%%%%%%%%%%%%%%
% Environments %
%%%%%%%%%%%%%%%%

\newenvironment{inlineschema}[1]
{\begin{minipage}{0.9\textwidth}
\vspace{-0.5em}
\setlength{\zedindent}{0pt}
\begin{schema}{#1}}
{\end{schema}
\end{minipage}
\vspace{0.5em}}

\newenvironment{ghostcolor}%
{\definecolor{ZedColor}{rgb}{0.5,0.5,0.5}\ignorespaces}%
{\ignorespacesafterend}

\renewenvironment{note}{\paragraph{Note}$\!$\color{Red}}{\medskip}

%%%%%%%%%%%%%%%%%%%
% Circus Theorems %
%%%%%%%%%%%%%%%%%%%

% Extension to the ntheorem package; we are abusing the type as a name.

\newcommand{\thname}[1]{\lname{\csname r@#1@type\endcsname}}

\theoremstyle{plain}
\theorembodyfont{\normalfont\upshape}

\newtheorem{circuslawthm}{{\Circus} Law}
\newtheorem{circustimelawthm}{{\CircusTime} Law}
\newtheorem{ohcircuslawthm}{{\OhCircus} Law}
\newtheorem{patternthm}{High-level Law}

\newenvironment{circuslaw}[1]%
{\begin{circuslawthm}[#1]\label{#1}[#1]\nounparsedcolour}%
{\end{circuslawthm}}

\newenvironment{circustimelaw}[1]%
{\begin{circustimelawthm}[#1]\label{#1}[#1]\nounparsedcolour}%
{\end{circustimelawthm}}

\newenvironment{ohcircuslaw}[1]%
{\begin{ohcircuslawthm}[#1]\label{#1}[#1]\nounparsedcolour}%
{\end{ohcircuslawthm}}

\newenvironment{pattern}[1]%
{\begin{patternthm}[#1]\label{#1}[#1]\nounparsedcolour}%
{\end{patternthm}}

\newcommand{\highlight}[1]{\red{#1}}
\newcommand{\unparsed}[1]{{\setunparsedcolour\color{ZedColor}#1}}

%%%%%%%%%%%%%%%%%
% Clean Version %
%%%%%%%%%%%%%%%%%

% The following commands should be enabled for a clean version.

%\renewcommand{\setunparsedcolour}{}
%\renewenvironment{note}{\comment}{\endcomment}
%\renewcommand{\todo}[1]{}
