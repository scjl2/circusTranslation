\begin{pattern}{seq-share-1}
\begin{circusaction*}
  \circblockopen
    (\circmu X \circspot A_1 \circseq c~!~x \then \Skip \circseq sync \then X)
    \also
    \t1 \lpar ns_1 | cs | ns_2 \rpar
    \also
    (\circmu X \circspot c~?~x \then A_2 \circseq sync \then X)
  \circblockclose
  \circhide \lchanset c \rchanset
  \also
  \t1 \equiv
  \also
  \circblockopen
    \circblockopen
      (\circmu X \circspot A_1 \circseq c_1~!~x \then \Skip \circseq c_3 \then \Skip \circseq sync \then X)
      \also
      \t1 \lpar ns_1 | (cs \setdiff \lchanset c \rchanset) \cup \lchanset c_3 \rchanset | ns_2 \rpar
      \also
      (\circmu X \circspot c_3 \then \Skip \circseq c_2~?~x \then A_2 \circseq sync \then X)
    \circblockclose
    \circhide \lchanset c_3 \rchanset
    \also
    \t1 \lpar ns_1 \cup ns_2 | \lchanset c_1, c_2 \rchanset | \emptyset \rpar
    \also
    \circblockopen
      \circvar v : T \circspot
      \\
      \t1 \circmu X \circspot
      \circblockopen
        (c_1~?~x \then v := x) ~ ~ \extchoice
        \\
        (c_2~!~v \then \Skip)
      \circblockclose
      \circseq X
    \circblockclose
  \circblockclose
  \circhide \lchanset c_1, c_2 \rchanset
  \also
  \provided ~ \lchanset c, sync \rchanset \subseteq cs \land c \notin \usedC(A_1) \cup \usedC(A_2) \; \provand \; \mbox{$c_1$, $c_2$ and $c_3$ are fresh channels}
\end{circusaction*}
\end{pattern}
